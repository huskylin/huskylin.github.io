{"meta":{"title":"å·¥ç¨‹å¸«éƒ½æ˜¯ä¸­äºŒç—…","subtitle":"","description":"","author":"huskylin","url":"https://huskylin.github.io","root":"/"},"pages":[{"title":"æ¨™ç±¤","date":"2020-06-28T10:07:31.270Z","updated":"2020-06-28T10:07:31.270Z","comments":false,"path":"tags/index.html","permalink":"https://huskylin.github.io/tags/index.html","excerpt":"","text":""},{"title":"404 Not Found","date":"2020-06-28T10:07:53.375Z","updated":"2020-06-28T10:07:53.375Z","comments":false,"path":"/404.html","permalink":"https://huskylin.github.io/404.html","excerpt":"","text":""},{"title":"é—œæ–¼","date":"2020-06-28T10:21:07.494Z","updated":"2020-06-28T10:21:07.494Z","comments":false,"path":"about/index.html","permalink":"https://huskylin.github.io/about/index.html","excerpt":"","text":"æŠ€è¡“ç›®å‰æ˜¯é›œç«¯å·¥ç¨‹å¸«ç›®å‰ä¸»è¦æŠ€è¡“æ˜¯JavaScriptä¸»è¦ä½¿ç”¨Angularæ¡†æ¶æ¬¡è¦æŠ€è¡“å‰‡æ˜¯Pythonå–œæ­¡ç”¨æŠ€è¡“å‰µé€ å„ç¨®æ±è¥¿è‡ªå·±çš„èƒ½åŠ›ï¼Œç¸½æ˜¯è·Ÿä¸ä¸Šä¸€å †æƒ³ç©çš„æ±è¥¿é™¤äº†å‰å¾Œç«¯ä»¥å¤–ï¼Œä¹Ÿå°APPã€è³‡å®‰æœ‰èˆˆè¶£ å€‹äººæˆé•·éå¸¸å–œæ­¡è§€å¯Ÿèˆ‡æ€è€ƒçš„æ±è¥¿å¶çˆ¾çœ‹çœ‹å¿ƒç†å­¸ã€å“²å­¸æ‰¹åˆ¤æ™‚äº‹ä¹‹é¡çš„ èˆˆè¶£éå¸¸å–œæ­¡éŸ³æ¨‚èˆ‡å”±æ­ŒPop, Jazz, Funkä¹Ÿå–œæ­¡å¥èº«èˆ‡çƒ¹é£ª"},{"title":"åˆ†é¡","date":"2020-06-28T10:07:39.017Z","updated":"2020-06-28T10:07:39.017Z","comments":false,"path":"categories/index.html","permalink":"https://huskylin.github.io/categories/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2020-06-28T07:34:49.290Z","updated":"2020-06-28T07:34:49.290Z","comments":false,"path":"repository/index.html","permalink":"https://huskylin.github.io/repository/index.html","excerpt":"","text":""},{"title":"ä¹¦å•","date":"2020-06-28T07:34:49.277Z","updated":"2020-06-28T07:34:49.277Z","comments":false,"path":"books/index.html","permalink":"https://huskylin.github.io/books/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2020-06-28T07:34:49.285Z","updated":"2020-06-28T07:34:49.285Z","comments":true,"path":"links/index.html","permalink":"https://huskylin.github.io/links/index.html","excerpt":"","text":""}],"posts":[{"title":"Redis åšè³‡æ–™å¿«å–çš„åŸºæœ¬ä½¿ç”¨ (æ­é…Node.js)","slug":"Redis-åšè³‡æ–™å¿«å–çš„åŸºæœ¬ä½¿ç”¨-æ­é…Node-js","date":"2020-07-10T10:11:48.000Z","updated":"2020-10-20T16:40:46.107Z","comments":true,"path":"2020/07/10/Redis-åšè³‡æ–™å¿«å–çš„åŸºæœ¬ä½¿ç”¨-æ­é…Node-js/","link":"","permalink":"https://huskylin.github.io/2020/07/10/Redis-%E5%81%9A%E8%B3%87%E6%96%99%E5%BF%AB%E5%8F%96%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8-%E6%90%AD%E9%85%8DNode-js/","excerpt":"","text":"Redis åšè³‡æ–™å¿«å–çš„åŸºæœ¬ä½¿ç”¨ (æ­é…Node.js)èƒŒæ™¯æœ‰äº›éœ€è¦è€—è²»å¤§é‡é‹ç®—çš„çµæœå¦‚æœèƒ½å¤ åœ¨ä¼ºæœå™¨ç«¯åšå¿«å–å¯ä»¥å°æ•ˆèƒ½æå‡å¾ˆæœ‰å¹«åŠ©å…ˆçœ‹é€™æ¬¡çš„çµæœå·¦é‚Šç‚ºåŸå§‹æƒ…æ³ï¼Œå³é‚Šç‚º Redis å¿«å–å¾Œ(æ¥µç«¯æ¡ˆä¾‹? T__T å®‰è£å·²ç¶“æœ‰å®‰è£æˆ–æ˜¯åªæ˜¯æƒ³çœ‹ä»‹ç´¹çš„å¯ä»¥è·³éé€™éƒ¨åˆ†å–”~ Redis Serverå»ºè­°æ¡ç”¨å®˜ç¶²é€™ç¨®ä¸‹è¼‰å£“ç¸®æª”å†å®‰è£çš„æ–¹å¼ä¸ç„¶ç›´æ¥ç”¨ apt-get å¸¸å¸¸é è¨­çš„ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬https://redis.io/download#installation $ wget http://download.redis.io/releases/redis-6.0.5.tar.gz $ tar xzf redis-6.0.5.tar.gz $ cd redis-6.0.5 $ make åœ¨èƒŒæ™¯å•Ÿå‹• redis-server $ src/redis-server --daemonize yes ä¸¦ä¸”æ¸¬è©¦ä¸€ä¸‹åŠŸèƒ½é‹ä½œæ­£å¸¸ $ redis&gt; set foo bar $ OK $ redis&gt; get foo $ &quot;bar&quot; Redis Clientæˆ‘è‡ªå·±æ˜¯ä½¿ç”¨ Node.jsæ‰€ä»¥å…ˆå®‰è£ node-redis å¥—ä»¶https://github.com/NodeRedis/node-redis npm install redis Github ä¸Šçš„ç¯„ä¾‹ä¹Ÿå¾ˆç°¡æ½”æ¸…æ¥š &lt;!-- å¼•å…¥æ¨¡çµ„ --&gt; const redis = require(&quot;redis&quot;); const client = redis.createClient(); &lt;!-- é€£æ¥ redis server --&gt; client.on(&quot;error&quot;, function(error) { console.error(error); }); &lt;!-- è¨­ç½®èˆ‡å–å¾— key / value --&gt; client.set(&quot;key&quot;, &quot;value&quot;, redis.print); client.get(&quot;key&quot;, redis.print); å¯¦éš›ä½¿ç”¨ä½¿ç”¨å¿«å–çš„é‚è¼¯ æŸ¥è©¢è³‡æ–™æ™‚ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ–¼å¿«å–ä¹‹ä¸­ æ˜¯ï¼Œå‰‡å¾å¿«å–ä¸­å–å¾—è³‡æ–™ ç›´æ¥å›å‚³çµ¦å‰ç«¯ å¦ï¼Œå‰‡å¾è³‡æ–™åº«ä¸­æŸ¥è©¢ å›å‚³çµ¦å‰ç«¯ ä¸¦ä¸”å¯«å…¥å¿«å–ä¹‹ä¸­ æ›´æ–°è³‡æ–™æ™‚ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨æ–¼å¿«å–ä¹‹ä¸­ æ˜¯ï¼Œå‰‡ä¸€ä½µæ›´æ–°å¿«å–è³‡æ–™ å¦ï¼Œå‰‡å¯«å…¥å¿«å–ä¸­è½‰æ›ç‚ºç¨‹å¼ç¢¼ // å–å¾—åœ–è¡¨è³‡æ–™ router.get(&#39;/someData&#39;, (req, res) =&gt; { // å–å¾—è«‹æ±‚åƒæ•¸ä¸¦å‚³æ›æˆ key const parm1 = req.query.parm1 const parm2 = req.query.parm2 const parm3 = req.query.parm3 const key = (`someData:${parm1}/${parm2}/${parm3}`).trim() const expireDay = 60 * 60 * 24; // æª¢æŸ¥è³‡æ–™æ˜¯å¦èƒ½å¤ å¾å¿«å–ä¸­å–å¾— redisClient.get(key, (err, rawdata) =&gt; { // å¯ä»¥åšéŒ¯èª¤è™•ç† if (err) { console.log(err) } // å¦‚æœå¿«å–ä¸­æ²’æœ‰é€™ç­†è³‡æ–™ï¼Œæœƒå›å‚³ null if (!!rawdata) { // redis ç„¡æ³•å„²å­˜ Javascript çš„ Object // é€™é‚Šæ˜¯ç›´æ¥å­˜æˆ string // æ‰€ä»¥éœ€è¦è½‰æ› const data = JSON.parse(rawdata); return res.json(data); } // é€™é‚Šæ˜¯å‘¼å«ä½ æ’ˆè³‡æ–™åº«çš„ function yourSQL.queryData(parm1, parm2, parm3) .then(results =&gt; { // å¯«å…¥å¿«å–ï¼Œä¸¦ä¸”è¨­ç½®æœ‰æ•ˆæœŸé™ç‚ºä¸€å¤© redisClient.set(key, JSON.stringify(results), &#39;EX&#39;, expireDay, err =&gt; { if (err) { console.log(err) } }); // å›å‚³è³‡æ–™ res.json(results); }) .catch(err =&gt; { // è³‡æ–™åº«çš„æŸ¥è©¢çš„éŒ¯èª¤è™•ç† console.log(&quot;not connected due to error: &quot; + err); res.status(500).send(&#39;Can not connect to DB&#39;); }); }); }); å€¼å¾—æ³¨æ„çš„åœ°æ–¹key çš„å–åå› ç‚º key çš„é•·åº¦æœƒå½±éŸ¿åˆ° Redis æŸ¥è©¢çš„æ•ˆèƒ½æ‰€ä»¥è¨­è¨ˆå¥½çš„ key æ˜¯éœ€è¦çš„é—œä¹å–åçš„æ±è¥¿è¦è¤‡é›œéƒ½å¯ä»¥å¾ˆè¤‡é›œä½†æˆ‘è¦ºå¾—æœ€å¤§åŸå‰‡å°±æ˜¯å…§éƒ¨æºé€šå¥½ã€å¥½ç®¡ç†å°±å¥½å¯ä»¥åƒè€ƒ SatckOverflow ä¸Šæœ‰äººè¬›åˆ°å¸¸è¦‹çš„å‘½åæ–¹å¼redis-key-naming-conventions We use a colon (:) as namespace separator and a hash (#) for id-parts of keys, e.g.:logistics:building#23 value çš„è³‡æ–™å‹æ…‹Redis ç›®å‰æœ‰äº”ç¨®è³‡æ–™å‹æ…‹: string hash list set zset (sorted set) æˆ‘é€™é‚ŠåŸæœ¬æ˜¯æƒ³ç›´æ¥æŠŠè³‡æ–™åº«æ’ˆå‡ºä¾†çš„çµæœ (Objectå‹æ…‹) å­˜å…¥ä½†æ˜¯å› ç‚º Redis ä¸¦æ²’æœ‰é€™ç¨®è³‡æ–™å‹æ…‹æ‰€ä»¥å°±ç›´æ¥ç²—æš´çš„è½‰æˆå­—ä¸²å­˜å…¥èˆ‡å–å‡ºæ™‚é€éJSON.stringify, JSON.parse ä¾†è™•ç†æ‡‰è©²æœ‰æ›´å¥½çš„åšæ³•å•¦ æœ‰æ•ˆæœŸé™çš„è¨­ç½® å¦‚æœä¸æ˜¯éœ€è¦å¸¸é§çš„è³‡æ–™ ç›¡é‡éƒ½è¦è¨­ç½®æœ‰æ•ˆæœŸé™ (éœ€è¦å¸¸é§çš„è³‡æ–™ä¹Ÿæ‡‰è©²è¦è¨˜å¾—å­˜æ–¼å¯¦é«”è³‡æ–™åº«ä¸­) è¨­ç½®åˆç†çš„æœ‰æ•ˆæœŸé™ å¤ªé•·ï¼Œå ç”¨è¨˜æ†¶é«”ç©ºé–“ å¤ªçŸ­ï¼Œå®¹æ˜“é‡è¦†è®€å¯«æµªè²»æ•ˆèƒ½ åœ¨ç¯„ä¾‹çš„ Node.js ä¸­ èªæ³•ç‚ºåœ¨ set æ–¹æ³•è£¡å‚³å…¥åƒæ•¸ &#39;EX&#39;, expire redisClient.set(key, value, &#39;EX&#39;, expire, err =&gt; { ... }); è¶…éè¨˜æ†¶é«”ä¸Šé™å¾Œçš„è™•ç†ã€æ·˜æ±°æ©Ÿåˆ¶ noeviction: å³ä½¿è¨˜æ†¶é«”ä¸Šé”åˆ°ä¸Šé™ï¼Œä¹Ÿä¸ç½®æ› key-value ä¹Ÿå°±æ˜¯è¨˜æ†¶é«”æ»¿äº†ä¹‹å¾Œï¼Œåªèƒ½è®€å–è³‡æ–™ï¼Œä¸èƒ½å¯«å…¥ è‹¥å†æ–°å¢è³‡æ–™æœƒ return error é€™æ˜¯é è¨­å€¼ï¼Œæˆ‘èªç‚ºä¸é©ç”¨æ–¼å¤šæ•¸å ´åˆï¼Œæ‰€æ‡‰è©²è¦å»è¨­å®šæˆä¸‹åˆ—å…¶ä»–çš„ allkeys-lru: å„ªå…ˆåˆªé™¤æ‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyï¼Œç”¨ä»¥ä¿å­˜æ–°æ•¸æ“š LRU = least recently usedé©ç”¨å¤šæ•¸å ´åˆ volatile-lru: åªå¾æœ‰è¨­ç½®æœ‰æ•ˆæœŸé™ (expire) çš„è³‡æ–™ä¸­ é¸æ“‡æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ key-value é€²è¡Œåˆªé™¤ èˆ‡ allkeys-lru çš„å·®åˆ¥åœ¨æ–¼ä¸€å€‹å¾å…¨éƒ¨çš„ key ä¸­ä¾†é¸æ“‡åˆªé™¤ä¸€å€‹æ˜¯åªæœƒå¾æœ‰æœ‰æ•ˆæœŸé™çš„ key ä¾†é¸æ“‡åˆªé™¤ allkeys-random: å¾å…¨éƒ¨çš„ key ä¸­ éš¨æ©Ÿé¸æ“‡ä¸€äº›é€²è¡Œåˆªé™¤ volatile-random: åªå¾æœ‰è¨­ç½®æœ‰æ•ˆæœŸé™ (expire) key ä¸­ éš¨æ©Ÿé¸æ“‡ä¸€äº› key é€²è¡Œåˆªé™¤ volatile-ttl: åªå¾æœ‰è¨­ç½®æœ‰æ•ˆæœŸé™ (expire) key ä¸­ é¸å‡ºå‰©é¤˜å­˜æ´»æ™‚é–“ (TTL) æœ€çŸ­çš„ key é€²è¡Œåˆªé™¤ TTL = Time To Live å…¶ä»–åƒè€ƒè³‡æ–™ [Node.js] ä½¿ç”¨ Redis å…§å­˜ä¾†å­˜å–æœ¬åœ°è³‡æ–™ Redisçš„è¿‡æœŸç­–ç•¥åŠæ·˜æ±°ç­–ç•¥ Redisåˆ é™¤ç­–ç•¥å’Œé€å‡ºç­–ç•¥","categories":[],"tags":[{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"Node.js","slug":"Node-js","permalink":"https://huskylin.github.io/tags/Node-js/"}]},{"title":"MySQL åœ¨æ¯å€‹ç¾¤çµ„ä¸­å– N ç­†è³‡æ–™ ( Get 1...N Results From Each Group )","slug":"MySQL-åœ¨æ¯å€‹ç¾¤çµ„ä¸­å–-N-ç­†è³‡æ–™-Get-1-N-Results-From-Each-Group","date":"2020-06-28T07:27:47.000Z","updated":"2020-06-28T08:59:40.269Z","comments":true,"path":"2020/06/28/MySQL-åœ¨æ¯å€‹ç¾¤çµ„ä¸­å–-N-ç­†è³‡æ–™-Get-1-N-Results-From-Each-Group/","link":"","permalink":"https://huskylin.github.io/2020/06/28/MySQL-%E5%9C%A8%E6%AF%8F%E5%80%8B%E7%BE%A4%E7%B5%84%E4%B8%AD%E5%8F%96-N-%E7%AD%86%E8%B3%87%E6%96%99-Get-1-N-Results-From-Each-Group/","excerpt":"","text":"MySQL åœ¨æ¯å€‹ç¾¤çµ„ä¸­å– N ç­†è³‡æ–™ ( Get 1â€¦N Results From Each Group )èƒŒæ™¯å¦‚æœåªæƒ³æ’ˆå– GROUP BY å¾Œï¼Œæ¯ä¸€å€‹ GROUP è£¡é¢çš„å‰ 1â€¦n ç­†è³‡æ–™ä¾‹å¦‚: Person Height Weight UpdateTime Andy 150 52 2018-06-01 Andy 155 55 2019-08-01 Andy 160 58 2020-09-01 Bob 162 57 2018-06-01 Bob 164 62 2019-08-01 Bob 168 65 2020-09-01 é€™æ˜¯ä¸€å¼µè¨˜éŒ„èº«é«˜é«”é‡çš„è¡¨è€Œæ±ºå®šæ¯ç­†è³‡æ–™æ˜¯å”¯ä¸€çš„ PK å°±æ˜¯Name + UpdateTime å•é¡Œå‡è¨­æƒ³è¦å–å¾—æ¯å€‹äººæœ€æ–°çš„é«”æ…‹è³‡æ–™é‚£éº¼ç›´è¦ºå°±æœƒæƒ³åˆ°å…ˆæŠŠä»–å€‘ GROUP BY å¾Œå†ä¾†ç”¨ ORDER BYå†ä¾†ç”¨ LIMITå†ä¾†ç”¨â€¦.. åˆ°åº•è¦ç”¨å•¥æœ€å¾Œè…¦è¢‹ä¸€ç‰‡æ¸¾æ²Œåœ°çµ„å‡ºä¸€å¨å‹‰å¼·é€šéèªæ³•æª¢æŸ¥çš„å¼å­ SELECT Person, Height, Weight, UpdateTime FROM BodyInfoTable GROUP BY Person, UpdateTime ORDER BY UpdateTime DESC LIMIT 1 ç„¶å¾Œå°±å¯ä»¥é–‹é–‹å¿ƒå¿ƒåœ°çœ‹è¦‹â€¦å„ç¨®éŒ¯èª¤èˆ‡ä¸æ˜¯ä½ æƒ³è¦çš„çµæœ :) è§£æ³•ä¸€ï¼Œä½¿ç”¨ Variablesé‚£éº¼å†ä¾†å°±æ˜¯é€™æ¬¡çš„ä¸»é¡Œé‡å°æ¯ä¸€å€‹ GROUP å–å¹¾ç­†è³‡æ–™æŸ¥è©¢äº† StackOverflow ä¸Šçš„å•ç­”å¾Œçš„è§£æ³•Using LIMIT within GROUP BY to get N results per dynamic groupmysql limit inside groupå¥—ç”¨åœ¨ç¯„ä¾‹çš„æƒ…å¢ƒä¸­å°±æœƒé•·é€™æ¨£ SELECT Person, Height, Weight, UpdateTime FROM (SELECT x.*, CASE WHEN @prev = Person THEN @i:=@i + 1 ELSE @i:=1 END i, @prev:=Person FROM BodyInfoTable x, (SELECT @prev:=NULL, @i:=0) vars ORDER BY Person, UpdateTime ) a WHERE i &lt;= 1; æœ€é—œéµçš„éƒ¨åˆ†å°±æ˜¯å®ƒä½¿ç”¨äº†Variablesæ­é…case-whenä¾†å®Œæˆç•¶ Person æ¬„ä½é‡è¦†çš„æ™‚å€™ i å°±æœƒ +1èª¿æ•´ ORDER BY èˆ‡ i &lt;= å¤šå°‘å°±å¯ä»¥æ±ºå®šæƒ³è¦æŒ‰ç…§ä»€éº¼æ¢ä»¶ä¾†å–å¾—å‰ n ç­†è³‡æ–™äº† Variables è®Šæ•¸: @prev:=Person You can store a value in a user-defined variable in one statement and refer to it later in another statement. This enables you to pass values from one statement to another. å‡ºç¾å¦ä¸€å€‹å•é¡ŒåŸæœ¬æƒ³èªªå¤§åŠŸå‘Šæˆï¼Œé€™é•·å¾—é€™éº¼é†œè¤‡é›œæŠŠå®ƒå„²å­˜æˆ View å§ç™»æ„£~ ç›´æ¥å™´å‡ºä¸€å€‹å¤§å¤§çš„éŒ¯èª¤Error 1351: View&#39;s SELECT contains a variable or parameter SQL Statement:...ç›´æ¥æ‹¿éŒ¯èª¤é¤µç‹—å¾Œæ‰çŸ¥é“View è£¡é¢æ˜¯ä¸èƒ½ä½¿ç”¨ Variables çš„!!å¦‚æœå …æŒè¦ç”¨ï¼Œå°±å¿…é ˆç”¨å¾ˆ tricky çš„å¯«æ³•çœ‹åˆ°é€™é‚Šâ€¦æˆ‘åªèƒ½èªªã€Œæˆ‘OKï¼Œä½ å…ˆç”¨ã€é¦¬ä¸Šè·³æ§½ç”¨åˆ¥çš„å¯«æ³• è§£æ³•äºŒï¼Œä½¿ç”¨ ROW_NUMBER()åŸä¾†é€™ç¨®é¡å‹çš„æ“ä½œæ˜¯å› ç‚ºåœ¨MySQL 8ä»¥å‰æ‰éœ€è¦é€™éº¼å…‹é›£ã€å±•ç¾æ‰‹åšè·äººç²¾ç¥MySQL 8ä»¥å¾Œå°±ç›´æ¥ç”¨è¶…æ£’æ£’å‡½æ•¸å°±å¥½å•¦In MySQL 8 or later just use the RANK, DENSE_RANK or ROW_NUMBER functions:å¥—ç”¨åœ¨ç¯„ä¾‹çš„SQLå°±æœƒé•·é€™æ¨£ SELECT Person, Height, Weight, UpdateTime FROM ( SELECT *, ROW_NUMBER() OVER (partition by Person ORDER BY Person, UpdateTime) AS vars FROM TainanParking.GridStatic ) as a WHERE num &lt;= 1 æ’ˆå‡ºä¾†æ‡‰è©²å°±æœƒåƒæ˜¯ Person Height Weight UpdateTime Andy 160 58 2020-09-01 Bob 168 65 2020-09-01 é€™ç¨®å¯«æ³•çœŸçš„æ˜¯å¥½å¤šäº†è€Œä¸”é€™å€‹éœ€æ±‚æ‡‰è©²å¾ˆå¸¸ç”¨åˆ°ï¼Œè¶•ç·Šç­†è¨˜èµ·ä¾†çµ‚æ–¼æ‰“å®Œäº†~ ä¸‹èª²å•¦~","categories":[],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"https://huskylin.github.io/tags/MySQL/"}]},{"title":"Node.js + PM2 è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼Œæ›´å½ˆæ€§åœ°é–‹ç™¼èˆ‡éƒ¨å±¬","slug":"Node-js-PM2-è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼Œæ›´å½ˆæ€§åœ°é–‹ç™¼èˆ‡éƒ¨å±¬","date":"2020-06-18T10:10:00.000Z","updated":"2020-07-18T10:11:22.883Z","comments":true,"path":"2020/06/18/Node-js-PM2-è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼Œæ›´å½ˆæ€§åœ°é–‹ç™¼èˆ‡éƒ¨å±¬/","link":"","permalink":"https://huskylin.github.io/2020/06/18/Node-js-PM2-%E8%A8%AD%E7%BD%AE%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%EF%BC%8C%E6%9B%B4%E5%BD%88%E6%80%A7%E5%9C%B0%E9%96%8B%E7%99%BC%E8%88%87%E9%83%A8%E5%B1%AC/","excerpt":"","text":"Node.js + PM2 è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼Œæ›´å½ˆæ€§åœ°é–‹ç™¼èˆ‡éƒ¨å±¬èƒŒæ™¯åœ¨ä½¿ç”¨ node.js æ™‚ä¸€å®šæœƒé‡åˆ°é–‹ç™¼(dev)èˆ‡ç”Ÿç”¢(production)ï¼Œç”šè‡³æ›´å¤šéšæ®µçš„ä¸åŒç’°å¢ƒå¯èƒ½æ¯ä¸€ç¨®ç’°å¢ƒéƒ½æœ‰ä¸åŒçš„è¨­å®šæª”æ¡ˆä¾‹å¦‚:é–‹ç™¼éšæ®µè¦é€£ç·šåˆ°æœ¬æ©Ÿçš„è³‡æ–™åº«ç”Ÿç”¢éšæ®µè¦é€£ç·šåˆ°å¦ä¸€å°ä¼ºæœå™¨çš„è³‡æ–™åº«é€™æ™‚å€™å°±éœ€è¦æ›´å½ˆæ€§çš„ä¾†åšè¨­å®š åœ¨ Node.js è¨­å®š configå¯ä»¥é‡å°ä¸åŒçš„éšæ®µç’°å¢ƒä¾†è¨­å®šå„ç¨®é€£ç·šåƒæ•¸ä¾‹å¦‚: const env = process.env.NODE_ENV; // &#39;dev&#39; or &#39;prod&#39; const configs = {} configs.dev = { db: { host: &#39;YourHost1&#39;, port: 3306, user: &quot;YourUser&quot;, password: &#39;yourPassword1&#39;, database: &#39;YourDB1&#39; } }; configs.prod = { db: { host: &#39;YourHost2&#39;, port: 3306, user: &quot;YourUser2&quot;, password: &#39;yourPassword2&#39;, database: &#39;YourDB2&#39; } } module.exports = configs[env]; å¦‚æ­¤ä¸€ä¾† Node.js å°±æœƒæ ¹æ“šç’°å¢ƒè®Šæ•¸ä¾† exports ä¸åŒçš„è¨­å®š ä½¿ç”¨ PM2 ä¾†é‹è¡Œ Node.js æ™‚PM2 æ˜¯ä¸€å€‹ node çš„ç¨‹åºç®¡ç†å™¨ä¸»è¦åŠŸèƒ½æœ‰è‡ªå‹•é‡å•Ÿæœå‹™, å¢é›†åŠŸèƒ½æ›´æœ‰æ•ˆçš„åˆ©ç”¨å¤šæ ¸CPUç­‰ç­‰ç¶²è·¯ä¸Šä»‹ç´¹éå¸¸å¤šï¼Œå¯ä»¥åƒè€ƒé€™äº›é€£çµä¾†çœ‹ä»‹ç´¹èˆ‡ç”¨æ³• pm2 - ç”¨æ³•å¤§å…¨ ä½¿ç”¨ pm2 å•Ÿå‹• Node.js cluster ä»¥æå‡æ•ˆèƒ½ æˆ‘ä¸»è¦æƒ³åˆ†äº«çš„æ˜¯ï¼Œç•¶æˆ‘å€‘ä½¿ç”¨ PM2 æ™‚å¸Œæœ›åœ¨å¢é›†æ¨¡å¼(cluster)ä¸‹é‹è¡ŒNodeæœå‹™ï¼Œåˆè¦è¨­å®šç’°å¢ƒè®Šæ•¸æ™‚çš„ä½œæ³•ä¸€é–‹å§‹ç›´è¦ºçš„æƒ³æ³•æ˜¯ç›´æ¥éƒ½æ‰“åœ¨åƒæ•¸ how to â€œnpm startâ€ with pm2 cluster mode Passing environment variables to node.js using pm2 å¾Œä¾†ç™¼ç¾æ¯”è¼ƒå¥½çš„åšæ³•ï¼Œæ˜¯è¨­ç½®ä¸€å€‹PM2çš„åƒæ•¸è¨­å®šæª”(å¾Œä¾†æ‰ç™¼ç¾å…¶å¯¦å®˜æ–¹çš„æ–‡ä»¶å°±å¯«å¾—å¾ˆæ¸…æ¥šäº†) ä½¿ç”¨ Ecosystem FilePM2å®˜æ–¹æ–‡ä»¶ å…ˆç”¢ç”Ÿä¸€å€‹ecosystem.config.js è¨­ç½®ç¯„ä¾‹ module.exports = { apps : [{ name: &quot;app&quot;, script: &quot;./app.js&quot;, env: { NODE_ENV: &quot;development&quot;, }, env_production: { NODE_ENV: &quot;production&quot;, } }] } é‹è¡ŒæŒ‡ä»¤ pm2 start ecosystem.config.js --env production é€™è£¡å€¼å¾—ç•™æ„çš„æ˜¯åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ--envé€™å€‹åƒæ•¸å¾Œé¢æ¥æ˜¯productionè€Œä¸æ˜¯env_productionæˆ‘åŸæœ¬æƒ³èªªæ‡‰è©²æ˜¯è¦è¼¸å…¥è¨­å®šæª”çš„ Object keyçµæœç›´æ¥å¤±æ•—ï¼Œæˆ‘é‚„ä¸å¤ é›£å—?å·®é»èººåœ¨åºŠä¸Šè“‹è‘—é¢è¢«æŠ±è‘—è‡ªå·±å“­å‡ºä¾† å¾Œä¾†åˆç™¼ç¾å…¶å¯¦åœ¨æ›´ä¸‹é¢çš„å®˜æ–¹æ–‡ä»¶åˆæœ‰èªªæ˜äº† Example: # Inject what is declared in env_production pm2 start process.json --env production # Inject what is declared in env_staging pm2 restart process.json --env staging ( å®³æˆ‘ä¸èƒ½æ€ªå®˜æ–¹æ²’å¯«æ¸…æ¥šäº† )( æ”¹æ€ªä»–æ€éº¼åˆ†é‚£éº¼é–‹å¥½äº† QQ ) å»¢è©±æ™‚é–“æ”¹é€ å®Œè‡ªå·±çš„è¨­ç½®æ˜¯ä¸æ˜¯è¦ºå¾—è‡ªå·±çš„Node.js Serverè®Šå¾—æ›´é€²åŒ–å•¦é€²åŒ–ç‚º Dev &amp; Production çš†å¯é©æ‡‰çš„é›™æ£²å‹•ç‰©ç»å”±ä¸€é¦–è”¡å¥é›…çš„é›™æ£²å‹•ç‰© å¾ˆæƒ³å“­~ å“­å®Œç„¡åŠ©~ æ‰“å®Œæ”¶å·¥!","categories":[],"tags":[{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"Node.js","slug":"Node-js","permalink":"https://huskylin.github.io/tags/Node-js/"}]},{"title":"åœ¨Node.JSé€éODBCé€£æ¥impalaå®Œæ•´æ•™å­¸(ä¸‹)","slug":"åœ¨Node-JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸-ä¸‹","date":"2020-06-17T10:00:22.000Z","updated":"2020-06-28T09:14:55.305Z","comments":true,"path":"2020/06/17/åœ¨Node-JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸-ä¸‹/","link":"","permalink":"https://huskylin.github.io/2020/06/17/%E5%9C%A8Node-JS%E9%80%8F%E9%81%8EODBC%E9%80%A3%E6%8E%A5Impala%E5%AE%8C%E6%95%B4%E6%95%99%E5%AD%B8-%E4%B8%8B/","excerpt":"","text":"åœ¨Node.JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸(ä¸‹)æ­¥é©ŸäºŒï¼Œåœ¨ Node.js ä¸Šé€£æ¥åˆ° Ubuntu ä¸Šçš„ ODBCä¸Šä¸€ç¯‡å®Œæˆäº†åœ¨ Ubuntu ä¸Šå®‰è£ ODBC Driverçš„éƒ¨åˆ†æ¥ä¸‹ä¾†å°±æ˜¯é€é Node.jsä¾†é€£æ¥å•¦ 1. å®‰è£å¥—ä»¶çœ‹äº†ä¸€ä¸‹ Node.js é€£æ¥ ODBCçš„ ç›¸é—œå¥—ä»¶é€™å¥—æ˜¯åˆ°è¿‘æœŸéƒ½é‚„æœ‰æœ‰ç¶­æŒæ›´æ–°çš„ï¼Œå› æ­¤æ¡ç”¨node-odbc npm install odbc 2. è¨­å®šé€£æ¥å®˜æ–¹ç¯„ä¾‹ const odbc = require(&#39;odbc&#39;); async function connectToDatabase() { const connection1 = await odbc.connect(&#39;DSN=MYDSN&#39;); // connection1 is now an open Connection // or using a configuration object const connectionConfig = { connectionString: &#39;DSN=MYDSN&#39;, connectionTimeout: 10, loginTimeout: 10, } const connection2 = await odbc.connect(connectionConfig); // connection2 is now an open Connection } connectToDatabase(); é€™é‚Šæ¯”è¼ƒè¦æ³¨æ„çš„æ˜¯connectionString: &#39;DSN=MYDSN&#39;é€™å€‹DSNå°±æ˜¯Data Source Nameå¦‚æœæ˜¯æŒ‰ç…§ä¸Šä¸€ç¯‡çš„ç¯„ä¾‹ï¼Œæˆ‘å€‘æ˜¯å–åç‚ºimpalaodbcæ‰€ä»¥æœƒé•·é€™æ¨£ const connectionConfig = { connectionString: &#39;DSN=impalaodbc&#39;, connectionTimeout: 10, loginTimeout: 10, } 3. åŸ·è¡Œ QueryåŸ·è¡Œ Queryã€Pool å¯ä»¥åœ¨å®˜æ–¹æ–‡ä»¶ä¸ŠæŸ¥è©¢ API èˆ‡ç¯„ä¾‹é€™å€‹å¥—ä»¶çš„å®˜æ–¹æ–‡ä»¶ API å¯«å¾—è »æ¸…æ¥šçš„ä¸»è¦å¯ä»¥åœ¨ä¸Šé¢çœ‹ä½†æ˜¯å€¼å¾—æ³¨æ„çš„æ˜¯Impala çš„æ¬„ä½åç¨±æ˜¯ä¸åˆ†å¤§å°å¯«çš„Impala çš„æ¬„ä½åç¨±æ˜¯ä¸åˆ†å¤§å°å¯«çš„Impala çš„æ¬„ä½åç¨±æ˜¯ä¸åˆ†å¤§å°å¯«çš„ Impala identifiers are always case-insensitive. That is, tables named t1 and T1 always refer to the same table, regardless of quote characters. Internally, Impala always folds all specified table and column names to lowercase. This is why the column headers in query output are always displayed in lowercase.å®˜æ–¹æ–‡ä»¶èªªæ˜ åƒæˆ‘æ˜¯å¾MySQLè½‰ç§»éä¾†çš„å°±æœƒé‡åˆ°å•é¡Œæ‰€ä»¥æˆ‘å¯«äº†ä¸€å€‹å–ä»£æ¬„ä½åç¨±çš„ Functionç¬¬ä¸€å€‹åƒæ•¸æ˜¯å¾Impalaæ’ˆå›ä¾†çš„è³‡æ–™ç¬¬äºŒå€‹åƒæ•¸å‰‡æ˜¯ä½ å¸Œæœ›å–ä»£çš„æ¬„ä½åç¨±ä¾‹å¦‚: [&#39;Id&#39;, &#39;InfoDate&#39;, &#39;ColName&#39;, &#39;Something&#39;...]ç›´æ¥å–ä»£æ¯ä¸€å€‹ç‰©ä»¶çš„key function toCaseSensitiveKeys(result, newKeys) { // make keys array to keys object const replacements = {}; if (newKeys !== undefined) { newKeys.forEach(key =&gt; { replacements[key.toLowerCase()] = key; }) } // pair keys by replacements object const data = result.map(row =&gt; { const replacedItems = Object.keys(row).map(key =&gt; { const newKey = replacements[key] || key; return { [newKey]: row[key] }; }) const newResult = replacedItems.reduce((a, b) =&gt; Object.assign({}, a, b)); return newResult; }); return data; } æœ€å¾Œçš„ Query Function const impalaQuery = (sql, values, newKeys) =&gt; { return new Promise((resolve, reject) =&gt; { // Create Connection Pool const connectionConfig = { connectionString: &#39;DSN=impalaodbc&#39;, connectionTimeout: 10, loginTimeout: 10, } odbc.connect(connectionConfig, (conError, connection) =&gt; { if (conError) { reject(conError); } connection.query(sql, values, (err, rows) =&gt; { if (err) { // If execute SQL faild, print SQL connection.createStatement((error1, statement) =&gt; { if (error1) { console.log(error1, statement); return; } // handle statement.prepare(sql, (error2) =&gt; { if (error2) { console.log(error2, statement); return; } // handle statement.bind(values, (error3) =&gt; { if (error3) { console.log(error3, statement); return; } // handle }); }); }); reject(err); } else { const idx = rows.indexOf(&#39;statement&#39;) const values = rows.slice(0, idx).map((e, i) =&gt; { return e }) const data = toCaseSensitiveKeys(values, newKeys); // print SQL console.log(rows[&#39;statement&#39;]); resolve(data); } }); }); }); }; ä¸»è¦æ˜¯åŠ å…¥äº† éŒ¯èª¤æ™‚é€ééšæ®µä¾†åµéŒ¯ å°å‡ºåŸ·è¡Œçš„SQL è½‰æ›å¤§å°å¯« åœ¨å…¶ä»–åœ°æ–¹å°±å¯ä»¥é€™æ¨£ä½¿ç”¨ const sql = &#39;yourSQL&#39;; const values = [SomeParms...]; const keys = [SomeColNames...]; impalaQuery(sql, values, keys) .then(results =&gt; { res.status(200).json(results); }) .catch(err =&gt; { console.log(err); res.status(500).send(&#39;DB Error&#39;); }); é€™æ¬¡çš„åœ¨Node.JSé€éODBCé€£æ¥Impalaå°±å¤§åŠŸå‘Šæˆå•¦!å…¶å¯¦è »è²»å·¥çš„ï¼Œå¯«é€™ç¯‡æ–‡æ™‚ä¹Ÿå›é¡§äº†ä¸å°‘è‹¦é›£å¸Œæœ›å¯ä»¥å¹«åŠ©åˆ°æœ‰åŒæ¨£éœ€æ±‚çš„äºº~","categories":[],"tags":[{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"Node.js","slug":"Node-js","permalink":"https://huskylin.github.io/tags/Node-js/"},{"name":"impala","slug":"impala","permalink":"https://huskylin.github.io/tags/impala/"},{"name":"ubuntu","slug":"ubuntu","permalink":"https://huskylin.github.io/tags/ubuntu/"},{"name":"hadoop","slug":"hadoop","permalink":"https://huskylin.github.io/tags/hadoop/"}]},{"title":"åœ¨Node.JSé€éODBCé€£æ¥impalaå®Œæ•´æ•™å­¸(ä¸Š)","slug":"åœ¨Node-JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸-ä¸Š","date":"2020-06-15T10:00:22.000Z","updated":"2020-06-28T09:13:14.306Z","comments":true,"path":"2020/06/15/åœ¨Node-JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸-ä¸Š/","link":"","permalink":"https://huskylin.github.io/2020/06/15/%E5%9C%A8Node-JS%E9%80%8F%E9%81%8EODBC%E9%80%A3%E6%8E%A5Impala%E5%AE%8C%E6%95%B4%E6%95%99%E5%AD%B8-%E4%B8%8A/","excerpt":"","text":"åœ¨Node.JSé€éODBCé€£æ¥Impalaå®Œæ•´æ•™å­¸(ä¸Š)èƒŒæ™¯åŸæœ¬å°ˆæ¡ˆçš„å¾Œç«¯ï¼Œåœ¨é–‹ç™¼éšæ®µæ™‚æ¡ç”¨Node.jsé€£æ¥MySQLçµæœå¾Œä¾†åˆ°éƒ¨å±¬éšæ®µæ™‚è¦æ”¹é€£æ¥åˆ°impalaåŸæœ¬ä»¥ç‚ºæ˜¯å°äº‹ä¸€æ¨ï¼Œå¾Œä¾†æ¡å‘é€£é€£æ–¼æ˜¯ç”¢ç”Ÿäº†æœ¬ç¯‡ç­†è¨˜ åˆå§‹æƒ³æ³• node-impala å¥—ä»¶ä¸€é–‹å§‹çœ‹åˆ° npm è£¡é¢å·²ç¶“æœ‰äººåšå¥½å¥—ä»¶äº†é€£æ¥ç¯„ä¾‹çœ‹èµ·ä¾†ä¹Ÿè »ç°¡æ½”çš„å°±ç›´æ¥æ¡ç”¨ node-impalaæ¸¬è©¦å¾Œçš„ç¢ºä¹Ÿè »å¿«å°±èƒ½å¤ é€£ä¸Šä¸¦ä¸”æ’ˆå–è³‡æ–™ä½†æ˜¯!!éå¾ˆä¹…ä¹‹å¾Œæ‰ç™¼ç¾ä»–çš„queryä¸€æ¬¡æœ€å¤šå›å‚³1024ç­†çµæœ!ä»–çš„queryä¸€æ¬¡æœ€å¤šå›å‚³1024ç­†çµæœ!ä»–çš„queryä¸€æ¬¡æœ€å¤šå›å‚³1024ç­†çµæœ! çœ‹äº†issueå¾Œæ‰ç™¼ç¾æ˜¯å› ç‚ºåº•å±¤ä½¿ç”¨Beeswaxä¾†é€£æ¥ï¼Œé€™æ˜¯Beeswaxçš„é™åˆ¶ç„¡æ³•æ”¹è®Š Beeswax limits the query result. It is not possible to increase the size by setting fetch_size here. Letâ€™s use the HiveServer2 #4. ğŸ™ˆ åŸè¨è«–ä¸² ç…ç†¬äº†ä¸€é™£å­å¾Œæ±ºå®šç›´æ¥æ”¾æ£„å¦å°‹ä»–è·¯ è§£æ³• ODBCå¾Œä¾†æ‰¾åˆ°çš„æ–¹æ³•æ˜¯åœ¨ç³»çµ±ç’°å¢ƒä¸‹å…ˆè£å¥½ ODBC ä¾†é€£æ¥ Impalaå¾Œç«¯ Node.js å†å»é€£ ODBCæˆ‘å€‘çš„ä½œæ¥­ç³»çµ±ç’°å¢ƒæ˜¯ä½¿ç”¨Ubuntu 18.04æ‰€ä»¥æ¥ä¸‹ä¾†å°±æ˜¯æœ‰å…©å€‹æ­¥é©Ÿè¦åŸ·è¡Œ åœ¨ Ubuntu ä¸Šå®‰è£ ODBC Driver åœ¨ Node.js ä¸Šé€£æ¥åˆ° Ubuntu ä¸Šçš„ ODBC æ­¥é©Ÿä¸€ï¼Œåœ¨ Ubuntu ä¸Šå®‰è£ ODBC Driver1. ä¸‹è¼‰å®‰è£åŒ…clouderaä¸‹è¼‰é€£çµCloudera ODBC Driver for Impala å®˜æ–¹æ–‡ä»¶èªªæ˜ 2. è¨­å®šç’°å¢ƒè®Šæ•¸export LD_LIBRARY_PATH=/usr/local/lib:/opt/cloudera/impalaodbc/lib/64 export CLOUDERAIMPALAINI=/opt/cloudera/impalaodbc/lib/64/cloudera.impalaodbc.ini export LD_PRELOAD=/usr/lib/x86_64-linux-gnu/libodbcinst.so export ODBCINI=/etc/odbc.ini export ODBCSYSINI=/etc 3. è¨­å®š ODBC driver çš„åƒæ•¸æª”å¤§è‡´ä¸Šé•·é€™æ¨£æ¯”è¼ƒéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ [impalaodbc] é€™æ˜¯ä½ è‡ªå·±è¦å–çš„ Data Source Name PORTè¦æ³¨æ„ä¸€ä¸‹æ˜¯21050é‚„æ˜¯21000 `Driveâ€µè·¯å¾‘ å¸³è™Ÿå¯†ç¢¼ã€DBä½ç½®ç­‰ç­‰å…¶ä»–éƒ½æ˜¯é è¨­å€¼è€Œå·²ï¼Œè‡ªè¡Œåƒè€ƒè®ŠåŒ–å³å¯ [impalaodbc] # Description: DSN Description. This key is not necessary and is only to give a description of the data # source. Description=Cloudera ODBC Driver for Impala (64-bit) DSN # Driver: The location where the ODBC driver is installed to. Driver=/opt/cloudera/impalaodbc/lib/64/libclouderaimpalaodbc64.so # The DriverUnicodeEncoding setting is only used for SimbaDM When set to 1, SimbaDM runs in UTF-16 mode. When #set to 2, SimbaDM runs in UTF-8 mode. DriverUnicodeEncoding=2 # Values for HOST, PORT, KrbFQDN, and KrbServiceName should be set here. They can also be specified on the # connection string. HOST=Impala Serverçš„IPä½ç½® PORT=21050 Database=DBåç¨± # The authentication mechanism. 0 - no authentication. 1 - Kerberos authentication 2 - Username # authentication. 3 - Username/password authentication. 4 - Username/password authentication with SSL. AuthMech=0 # Kerberos related settings. KrbFQDN= KrbRealm= KrbServiceName= # Username/password authentication with SSL settings. UID=DBå¸³è™Ÿ PWD=DBå¯†ç¢¼ CAIssuedCertNamesMismatch=1 TrustedCerts=/opt/cloudera/impalaodbc/lib/64/cacerts.pem # Specify the proxy user ID to use. DelegationUID= # General settings TSaslTransportBufSize=1000 RowsFetchedPerBlock=1000 SocketTimeout=0 4. å®‰è£ unixODBCsudo apt-get install unixODBC unixODBC-dev 5. æ¸¬è©¦ æŸ¥çœ‹ä½ çš„ODBCè¨­å®š odbcinst -q -s å¦‚æœæˆåŠŸçš„è©±æ‡‰è©²æœƒé¡¯ç¤ºä½ çš„ Data Source Name æ¸¬è©¦é€£ç·š isql -v impalaodbc å¦‚æœæˆåŠŸçš„è©±æ‡‰è©²æœƒé¡¯ç¤ºä½ çš„é€£ç·šå¾Œä»‹é¢ åˆ°é€™éƒ¨åˆ†å®Œæˆäº†åœ¨ Ubuntu ä¸Šå®‰è£ ODBC Driver\\ æ­å–œæ­å–œ / \\ ç‘èŠ±ç‘èŠ±/å–˜å£æ°£ï¼Œä¸‹ä¸€ç¯‡å†ä¾†è¬› æ­¥é©ŸäºŒ Node.js çš„éƒ¨åˆ†~ åƒè€ƒé€£çµ Installing Impala ODBC Driver in Ubuntu 64 bit Impala ODBC å®‰è£…ç¬”è®° ubuntu14.04é…ç½®impalaçš„odbcè¿æ¥","categories":[],"tags":[{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"Node.js","slug":"Node-js","permalink":"https://huskylin.github.io/tags/Node-js/"},{"name":"impala","slug":"impala","permalink":"https://huskylin.github.io/tags/impala/"},{"name":"ubuntu","slug":"ubuntu","permalink":"https://huskylin.github.io/tags/ubuntu/"},{"name":"hadoop","slug":"hadoop","permalink":"https://huskylin.github.io/tags/hadoop/"}]},{"title":"Ubuntu Server 18.04 é›¢ç·šç‹€æ…‹ä¸‹å®‰è£ MySQL","slug":"Ubuntu-Server-18-04-é›¢ç·šç‹€æ…‹ä¸‹å®‰è£-MySQL","date":"2019-07-16T03:35:15.000Z","updated":"2020-06-16T03:46:11.270Z","comments":true,"path":"2019/07/16/Ubuntu-Server-18-04-é›¢ç·šç‹€æ…‹ä¸‹å®‰è£-MySQL/","link":"","permalink":"https://huskylin.github.io/2019/07/16/Ubuntu-Server-18-04-%E9%9B%A2%E7%B7%9A%E7%8B%80%E6%85%8B%E4%B8%8B%E5%AE%89%E8%A3%9D-MySQL/","excerpt":"","text":"åœ¨ Ubuntu Server 18.04 é›¢ç·šç‹€æ…‹ä¸‹å®‰è£ MySQL (Install MySQL on Ubuntu While Offline)èƒŒæ™¯æœ€è¿‘ä¸€å€‹å°ˆæ¡ˆé‡åˆ°çš„æƒ…æ³ï¼ŒåŸºæ–¼è³‡å®‰æ”¿ç­–è€ƒé‡ï¼Œè¦å®šæ©Ÿå™¨ä¸èƒ½é€£å¤–éƒ¨ç¶²è·¯é€™æ¨£å°±ä¸èƒ½ç›´æ¥ä½¿ç”¨sudo apt-get install mysql-serveä¾†å®‰è£éç¨‹è »ä¸æ–¹ä¾¿çš„ï¼Œè¨˜éŒ„ä¸€ä¸‹çµ¦é‡åˆ°åŒæ¨£è™•å¢ƒçš„äººã€‚ä½œæ³•ä¸»è¦åƒè€ƒäº†é€™ç¯‡æ–‡ç« : ubuntu16.04 å®‰è£…ç¦»çº¿ mysql5.7.17ä½†æ˜¯MySQL 8.0 ç‰ˆæœ¬èˆ‡ä»¥å‰çš„ç‰ˆæœ¬å®‰è£æ­¥é©Ÿç•¥æœ‰ä¸åŒï¼Œæœƒåœ¨ä»¥ä¸‹å…§å®¹ä¸­æåˆ° æº–å‚™å®‰è£åŒ…1. ä¸‹è¼‰å°æ‡‰çš„ MySQL å®‰è£åŒ…æœ¬æ–‡ä»¥Ubuntu Linux 18.04 (x86, 64-bit), DEB Bundleç‚ºä¾‹ 2. æº–å‚™ USBæª¢æŸ¥ä¸€ä¸‹è£¡é¢åŒ…å«é€™äº›æª”æ¡ˆæŠŠmysql-server_8.0.16â€“2ubuntu18.04_amd64.deb-bundle.taræ”¾ç½®åˆ° USB éš¨èº«ç¢Ÿè£ç½®ä¸­ è¨»è¨˜: é€™é‚Š USB è¦å…ˆåœ¨ Ubuntu ç’°å¢ƒä¸­æ¸¬è©¦çœ‹çœ‹èƒ½ä¸èƒ½ç”¨ï¼Œæœ‰äº›éœ€è¦é‡æ–°æ ¼å¼åŒ– æ›è¼‰ USB éš¨èº«ç¢Ÿ1. å…ˆæŸ¥ USB éš¨èº«ç¢Ÿæ˜¯è¢«ç³»çµ±è¾¨è­˜æˆé‚£å€‹è£ç½®fdisk -lsda å¾ˆå¯èƒ½æ˜¯ç¡¬ç¢Ÿ,å¾€ä¸‹æŸ¥å®¹é‡å¯ä»¥æ‰¾åˆ°éš¨èº«ç¢Ÿçš„ç·¨è™Ÿæˆ‘å€‘å‡è¨­ç‚º sdb 2. å»ºç«‹ USB éš¨èº«ç¢Ÿçš„æ›è¼‰é»ï¼šmkdir /mnt/usb 3. æ›è¼‰ USB éš¨èº«ç¢Ÿmount -v -t auto /dev/sdb /mnt/usb -v é¡¯ç¤ºè³‡è¨Š-t auto è®“ç³»çµ±è‡ªå‹•åˆ†è¾¯æª”æ¡ˆç³»çµ± 4. åˆ° /mnt/usb å¯çœ‹åˆ° usb çš„å…§å®¹è§£å£“ç¸®å¾Œæª¢è¦–ä¸€ä¸‹æª”æ¡ˆ è¨»è¨˜: æª”åå¤šä¸€å€‹(1)çš„éƒ¨ä»½æ˜¯æˆ‘æœ‰é‡æ–°ä¸‹è¼‰éç¬¬ä¸€æ¬¡ä¸‹è¼‰æ™‚ä¸çŸ¥é“æ˜¯ä¸æ˜¯æª”æ¡ˆæœ‰æ¯€æï¼Œå‡ºç¾ç•°å¸¸éŒ¯èª¤å¦‚æœæœ‰é‡åˆ°ä¹Ÿå¯ä»¥è©¦è©¦çœ‹é‡æ–°ä¸‹è¼‰ é–‹å§‹å®‰è£1. ä¸‹è¼‰ä¾è³´çš„å®‰è£åŒ…æ ¹æ“šåƒè€ƒæ–‡ç« ï¼Œé‚„éœ€è¦å…©å€‹é¡å¤–ä¾è³´åŒ…ï¼Œå¯ä»¥åœ¨é€™é‚Šä¸‹è¼‰https://pkgs.org/download/libaio1https://pkgs.org/download/libmecab2 2. å®‰è£ MySQL sudo dpkg -i mysql-common_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg-preconfigure mysql-community-server_8.0.16â€“2ubuntu18.04_amd64.deb(é€™æ­¥é©Ÿæœƒè·³å‡ºå®‰è£ç•«é¢ï¼Œä¸¦ä¸”éœ€è¦è¼¸å…¥ root å¯†ç¢¼) sudo dpkg -i libmysqlclient21_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i libmysqlclient-dev_8.0.16â€“2ubuntu18.04_amd64.deb åƒè€ƒæ–‡ç« ä¸­é€™ä¸€æ­¥æ˜¯å®‰è£libmysqld-dev_5.7.16â€“1ubuntu16.04_amd64.debä½†æ˜¯æ ¹æ“šå®˜æ–¹ç‰ˆæœ¬è³‡è¨Šï¼Œ8.0 ç‰ˆæœ¬å·²ç¶“ä¸éœ€è¦é€™å€‹æª”æ¡ˆäº†ï¼Œæ‰€ä»¥ä¸éœ€è¦åšé€™å€‹æ­¥é©Ÿ åƒè€ƒæ–‡ç« ä¸­çš„é€™æ­¥é©Ÿæ˜¯å®‰è£mysql-community-client_8.0.16â€“2ubuntu18.04_amd64.debä¸éå¦‚æœç›´æ¥å®‰è£æœƒè·³å‡ºéŒ¯èª¤ï¼Œé¡¯ç¤ºç¼ºå°‘ä¾è³´ï¼Œæ‰€ä»¥åœ¨é€™ 8.0 ä¸­éœ€è¦å…ˆå®‰è£mysql-community-client-core_8.0.16â€“2ubuntu18.04_amd64.debæ‰€ä»¥åŸ·è¡Œsudo dpkg -i mysql-community-client-core_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i mysql-community-client_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i mysql-client_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i mysql-common_8.0.16â€“2ubuntu18.04_amd64.deb åƒè€ƒæ–‡ç« ä¸­çš„é€™æ­¥é©Ÿæ˜¯å®‰è£mysql-community-server_8.0.16â€“2ubuntu18.04_amd64.deä¸éå¦‚æœç›´æ¥å®‰è£æœƒè·³å‡ºéŒ¯èª¤ï¼Œé¡¯ç¤ºç¼ºå°‘ä¾è³´ï¼Œæ‰€ä»¥åœ¨é€™ 8.0 ä¸­éœ€è¦å…ˆå®‰è£mysql-community-server-core_8.0.16â€“2ubuntu18.04_amd64.debæ‰€ä»¥åŸ·è¡Œsudo dpkg -i mysql-community-server-core_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i mysql-community-server_8.0.16â€“2ubuntu18.04_amd64.deb sudo dpkg -i mysql-server_8.0.16â€“2ubuntu18.04_amd64.debæ‰“å®Œé€™ä¸€å¤§å¨æŒ‡ä»¤å¾Œï¼Œå°±å¤§åŠŸå‘Šæˆå•¦!æœ€å¾Œå¯ä»¥å» MySQL è£¡é¢è©¦ä¸€ä¸‹æŒ‡ä»¤ï¼Œç¢ºèªå®‰è£çµæœmysql -u root -p","categories":[],"tags":[{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://huskylin.github.io/tags/Ubuntu/"},{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"MySQL","slug":"MySQL","permalink":"https://huskylin.github.io/tags/MySQL/"}]},{"title":"Leafletè®€å–GeoJSONæª”","slug":"Leafletè®€å–GeoJSONæª”","date":"2018-10-07T10:00:22.000Z","updated":"2020-06-28T09:19:21.981Z","comments":true,"path":"2018/10/07/Leafletè®€å–GeoJSONæª”/","link":"","permalink":"https://huskylin.github.io/2018/10/07/Leaflet%E8%AE%80%E5%8F%96GeoJSON%E6%AA%94/","excerpt":"","text":"Leaflet è®€å– GeoJSON æª”é€éåœ¨åœ°åœ–ä¸ŠæŠŠå°ç£ç¸£å¸‚åœ°å€æ¡†é¸èµ·ä¾†ä¸¦ä¸”é»æ“Šå¾Œæœƒæœ‰ popup æç¤ºè©²åœ°å€çš„ç¸£å¸‚åç¨±ç·´ç¿’ Leaflet çš„ä¸€äº›æ“ä½œ èµ·æ­¥å…ˆç…§è‘—å®˜ç¶²æ•™å­¸å¼•å…¥ç›¸é—œæ–‡ä»¶æŠŠåˆå§‹åœ°åœ–å»ºå‡ºä¾†https://leafletjs.com/examples/quick-start/ // å»ºç«‹ Leaflet åœ°åœ– var map = L.map(&quot;mapid&quot;); // è¨­å®šç¶“ç·¯åº¦åº§æ¨™ map.setView(new L.LatLng(25, 121.74739), 13); // è¨­å®šåœ–è³‡ä¾†æº var osmUrl = &quot;https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png&quot;; var osm = new L.TileLayer(osmUrl, { minZoom: 3, maxZoom: 16 }); map.addLayer(osm); è®€å…¥ GeoJSON æª”æ ¹æ“šWeb è¦–è¦ºåŒ–(å››)ï¼šå»ºç«‹ OpenStreetMap åœ°åœ–æåˆ° Leaflet ç„¡æ³•ç›´æ¥è®€å– GeoJSON æª”æ¡ˆï¼Œå¿…é ˆå…ˆé€é Ajax ç­‰æ–¹å¼ä¸‹è¼‰ä¸‹ä¾†æ‰è¡Œã€‚é€™é‚Šå°‡ä½¿ç”¨ jQuery åšä¾‹å­ $.getJSON(&quot;YOURFILE.json&quot;, function (r) { L.geoJSON(r, { color: &quot;#333&quot; }).addTo(map); }); é€™æ¨£å°±å¯ä»¥è®€å– geoJSON æ›¿å€å¡Šè‘—è‰²å¸Œæœ›è®“ä¸åŒå€å¡Šæœ‰ä¸åŒé¡è‰²é€™é‚Šè©¦åšä¸€å€‹ï¼ŒæŠŠæ–°åŒ—å¸‚è‘—è‰² $.getJSON(&quot;taiwan.json&quot;, function (r) { L.geoJSON(r, { // æ¨£å¼å¯é€éfunctionæ“ä½œ style: function (feature) { if (feature.properties.COUNTYID == 65) { console.log(feature.properties.NAME_2014); return { color: &quot;#4f45c0&quot; }; } else { return { color: &quot;#444444&quot; }; } }, onEachFeature: onEachFeature, }).addTo(map); }); é»æ“Šå€å¡Šå½ˆå‡ºæç¤ºé€™é‚Šå¸Œæœ›è©²ç¸£å¸‚å€å¡Šå¾Œæœƒå½ˆå‡ºæç¤ºçš„è¦–çª—é€™é‚Šçš„ NAME_2014 æ˜¯è©²è³‡æ–™ä¸­çš„ properties æœ‰é€™å€‹ NAME_2014 å±¬æ€§è£¡é¢æ˜¯è©²ç¸£å¸‚åœ°å€çš„åå­— // ç¶å®šæ¯å€‹featureåšPopupï¼Œå¯ä»¥è¦–è³‡æ–™æœ‰ä»€éº¼propertiesä¾†æ±ºå®š function onEachFeature(feature, layer) { if (feature.properties &amp;&amp; feature.properties.NAME_2014) { layer.bindPopup(feature.properties.NAME_2014); } } å¦å¤–å†åŠ å…¥å®˜ç¶²ç¯„ä¾‹ä¸­é»åœ°åœ–çš„å…¶ä»–ä½ç½®å¾Œé¡¯ç¤ºåº§æ¨™ä½ç½® var popup = L.popup(); function onMapClick(e) { popup .setLatLng(e.latlng) .setContent(&quot;You clicked the map at &quot; + e.latlng.toString()) .openOn(map); } map.on(&quot;click&quot;, onMapClick); å…¶ä»–å»¶ä¼¸å¦‚æœæƒ³è¦è‡ªå·±ç¹ªè£½å¯ä»¥ä½¿ç”¨geojson.ioçš„æœå‹™ è³‡æ–™ä¾†æºä¸­è¯æ°‘åœ‹ç¸£å¸‚çš„ geojson æª”Leaflet å° GeoJSON çš„å®˜æ–¹èªªæ˜è€å¤–æ•™å­¸å½±ç‰‡","categories":[],"tags":[{"name":"Leaflet","slug":"Leaflet","permalink":"https://huskylin.github.io/tags/Leaflet/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://huskylin.github.io/tags/JavaScript/"}]},{"title":"CSSæ”¾å¤§åœ–ç‰‡æœƒçˆ†æ¡†","slug":"CSSæ”¾å¤§åœ–ç‰‡æœƒçˆ†æ¡†","date":"2018-09-01T10:08:02.000Z","updated":"2020-06-28T09:15:57.653Z","comments":true,"path":"2018/09/01/CSSæ”¾å¤§åœ–ç‰‡æœƒçˆ†æ¡†/","link":"","permalink":"https://huskylin.github.io/2018/09/01/CSS%E6%94%BE%E5%A4%A7%E5%9C%96%E7%89%87%E6%9C%83%E7%88%86%E6%A1%86/","excerpt":"","text":"åˆæ­¥æƒ³æ³•æƒ³è¦å¯¦ä½œä¸€å€‹æ»‘é¼ æ”¾ä¸Šå»æ™‚æœƒæ”¾å¤§åœ–ç‰‡ç°¡å–®çš„æ•ˆæœä½¿ç”¨åˆ°çš„æŠ€å·§ :hover Selectors(é¸æ“‡å™¨)ç”¨ä¾†é¸æ“‡æ»‘é¼ æŒ‡æ¨™ç¶“éåœ¨ä¸Šé¢æ™‚çš„å…ƒç´  transform: scale()transform å±¬æ€§è£¡ï¼Œç”¨ä¾†ç¸®æ”¾å…ƒç´ å¤§å° é€™å…©å€‹åŠ èµ·ä¾†å°±å¯ä»¥åšå‡ºä¸Šè¿°çš„æ•ˆæœä¸éè¢«é¸æ“‡åˆ°æ”¾å¤§å¾Œçš„åœ–ç‰‡æœƒçˆ†å‡ºæ¡†æ¡†é€™æ™‚å€™å°±éœ€è¦åŠ ä¸Šoverflow: hiddenç•¶è¶…å‡ºé‚Šç•Œç¯„åœæ™‚ï¼Œå°‡å¤šé¤˜çš„éƒ¨åˆ†éš±è—èµ·ä¾†ä¸é¡¯ç¤º å•é¡ŒåŸæœ¬ä»¥ç‚ºåˆ°é€™é‚Šå°±å¯ä»¥æˆåŠŸå°‡æ•ˆæœå‘ˆç¾ä½†æ˜¯å»ç™¼ç¾æœƒå› ç‚º padding çš„é–“è·è®“åœ–ç‰‡æ”¾å¤§çš„ç¯„åœæœ‰äº†â€äº‚é•·å¤§çš„ç©ºé–“â€ è§£æ±ºå¾Œä¾†åœ¨åœ–ç‰‡å¤–é¢å¤šåŒ…ä¸€å€‹ divä¸¦å°‡ overflow: hidden å¯«åœ¨è£¡é¢æ–‡å­—èˆ‡åœ–ç‰‡é–“çš„ padding å°±ä¸æœƒçµ¦åœ–ç‰‡äº‚é•·å¤§çš„ç©ºé–“äº† .col-grid { max-width: 450px; overflow: hidden; img { max-width: 450px; &amp;:hover { transform: scale(1.1); transition: 0.5s; } } } çµæœå·¦é‚Šç‚ºç›®æ¨™æ•ˆæœï¼Œå³é‚Šæ˜¯æœ‰éé æœŸçˆ†æ¡†çš„æ•ˆæœ","categories":[],"tags":[{"name":"CSS","slug":"CSS","permalink":"https://huskylin.github.io/tags/CSS/"}]},{"title":"ç”¨Pythonæ‰“é€ FBæŠ½çæ©Ÿï¼Œå°‡å›è¦†ç•™è¨€ä¹Ÿåˆ—å…¥åƒæŠ½çå–®","slug":"ç”¨Pythonæ‰“é€ FBæŠ½çæ©Ÿï¼Œå°‡å›è¦†ç•™è¨€ä¹Ÿåˆ—å…¥åƒæŠ½çå–®","date":"2018-05-13T10:11:47.000Z","updated":"2020-06-14T11:23:50.492Z","comments":true,"path":"2018/05/13/ç”¨Pythonæ‰“é€ FBæŠ½çæ©Ÿï¼Œå°‡å›è¦†ç•™è¨€ä¹Ÿåˆ—å…¥åƒæŠ½çå–®/","link":"","permalink":"https://huskylin.github.io/2018/05/13/%E7%94%A8Python%E6%89%93%E9%80%A0FB%E6%8A%BD%E7%8D%8E%E6%A9%9F%EF%BC%8C%E5%B0%87%E5%9B%9E%E8%A6%86%E7%95%99%E8%A8%80%E4%B9%9F%E5%88%97%E5%85%A5%E5%8F%83%E6%8A%BD%E7%8D%8E%E5%96%AE/","excerpt":"","text":"å‹•æ©Ÿæœ€è¿‘åœ¨è‡‰æ›¸ä¸ŠåƒåŠ æ´»å‹•éœ€è¦æœ‹å‹å€‘æŒ‰è®šæˆ‘å°±è¾¦äº†å€‹æŠ½çè®“å¤§å®¶åƒèˆ‡æœå°‹ä¸€ä¸‹ç·šä¸Šå·¥å…·æœå°‹çµæœå‰å¹¾å€‹ä¼¼ä¹éƒ½ç„¡æ³•å…è²»æ”¯æ´å€‹äººé é¢çš„æŠ½ç å½±ç‰‡æ•™å­¸å‰›å¥½ä¹‹å‰çœ‹åˆ°Pycone æ¾æœåŸå¸‚æœ‰ç›¸é—œçš„æ•™å­¸å½±ç‰‡çœ‹ä¸Šå»ä¸æœƒå¤ªè¤‡é›œï¼Œå°±ç…§è‘—å¯¦ä½œä¸€æ¬¡äº† å‰å°±å¦‚å½±ç‰‡æ‰€ç¤º å–å¾— Post çš„ ID Facebook Graph API å–å¾— Token (å­˜å–æ¬Šæ–) æ‹¿åˆ°è³‡æ–™ ä¸éåšåˆ°ä¸­é–“ç™¼ç¾ é€™å€‹æ•™å­¸ä¹Ÿæ˜¯åšçµ¦ç²‰çµ²åœ˜ä½¿ç”¨çš„ æˆ‘å¸Œæœ›è®“ç•™è¨€ä¸­å›è¦†çš„äººä¹ŸåŠ å…¥åå–® æ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸€ä¸‹ å–å¾—ç•™è¨€çš„å›è¦†ç”±æ–¼ Facebook çš„å·¢ç‹€ç•™è¨€çµæ§‹æ¯å€‹ç•™è¨€ä¹Ÿéƒ½æœ‰å„è‡ªç¨ç«‹çš„ IDè¦ä¸€ä¸€æŠ“å–æœ‰é»éº»ç…©é€™é‚Šç›´æ¥åœ¨èªæ³•çš„åœ°æ–¹ä½¿ç”¨ filter=stream è®“å®ƒè®Šæˆè³‡æ–™æµï¼Œå°±æœƒå…¨éƒ¨å±•é–‹ä¾†äº† å¦å¤–å¦‚æœç•™è¨€æ•¸å¤ªå¤šçš„è©±é‚„è¦åŠ ä¸Š limitå¦å‰‡æœ‰äº›æœƒé¡¯ç¤ºä¸å‡ºä¾†æƒ³è¦å…¨éƒ¨é¡¯ï¼Œå°±çµ¦ä¸€å€‹è¶…éç¸½ç•™è¨€æ•¸çš„æ•¸é‡å³å¯ limit=1000 æœ€å¾Œçš„èªæ³•ç‚º &lt;Your_Post_ID&gt;/comments?filter=stream&amp;limit=1000 æœ€å¾Œå–å¾—è³‡æ–™å¾Œå†åˆ©ç”¨ SET å»é™¤é‡è¤‡åå–®ï¼Œäº‚æ•¸æ’åºå¾Œå°å‡ºå°±å¯ä»¥å®Œæˆäº† å®Œæ•´çš„ç¨‹å¼ç¢¼çŸ­çŸ­å¹¾è¡Œå°±å¯ä»¥å®Œæˆäº†","categories":[],"tags":[{"name":"Python","slug":"Python","permalink":"https://huskylin.github.io/tags/Python/"}]}],"categories":[],"tags":[{"name":"éƒ¨å±¬","slug":"éƒ¨å±¬","permalink":"https://huskylin.github.io/tags/%E9%83%A8%E5%B1%AC/"},{"name":"Node.js","slug":"Node-js","permalink":"https://huskylin.github.io/tags/Node-js/"},{"name":"MySQL","slug":"MySQL","permalink":"https://huskylin.github.io/tags/MySQL/"},{"name":"impala","slug":"impala","permalink":"https://huskylin.github.io/tags/impala/"},{"name":"ubuntu","slug":"ubuntu","permalink":"https://huskylin.github.io/tags/ubuntu/"},{"name":"hadoop","slug":"hadoop","permalink":"https://huskylin.github.io/tags/hadoop/"},{"name":"Ubuntu","slug":"Ubuntu","permalink":"https://huskylin.github.io/tags/Ubuntu/"},{"name":"Leaflet","slug":"Leaflet","permalink":"https://huskylin.github.io/tags/Leaflet/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://huskylin.github.io/tags/JavaScript/"},{"name":"CSS","slug":"CSS","permalink":"https://huskylin.github.io/tags/CSS/"},{"name":"Python","slug":"Python","permalink":"https://huskylin.github.io/tags/Python/"}]}